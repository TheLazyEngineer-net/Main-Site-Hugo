{{- $page := .page }}
{{- $class := "" -}}
{{- range .menuEntries }}
  {{- $attrs := dict "href" .URL "class" $class }}
  {{- if $page.IsMenuCurrent .Menu . }}
    {{- $attrs = merge $attrs (dict "class" (printf "active %s" $class) "aria-current" "page") }}
  {{- else if $page.HasMenuCurrent .Menu .}}
    {{- $attrs = merge $attrs (dict "class" (printf "ancestor %s" $class) "aria-current" "true") }}
  {{- end }}
  {{- $name := .Name }}
  {{- with .Identifier }}
    {{- with T . }}
      {{- $name = . }}
    {{- end }}
  {{- end }}
  <li>
    <a
      {{- range $k, $v := $attrs }}
        {{- with $v }}
          {{- printf " %s=%q" $k $v | safeHTMLAttr }}
        {{- end }}
      {{- end -}}
    >{{ $name }}</a>
    {{- with .Children }}
      <ul>
        {{- partial "navbar.html" (dict "page" $page "menuEntries" .) }}
      </ul>
    {{- end }}
  </li>
{{- end }}
